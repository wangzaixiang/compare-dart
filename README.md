# 编程语言性能对比

本项目通过一些代码示例，来对比 C、Swift、Go、Dart、Java、Zig、Rust、Python、Lua 等编程语言的性能差异。

## 测试语言：
- C(gcc)
- C(clang)
- Swift
- Go
- Dart(JIT)
- Dart(AOT)
- Java(JVM)
- Java(Graal Native)
- Zig
- Rust
- Python(CPython)
- Python(PyPy)
- Lua
- Lua(JIT)

## 测试案例
- fib 43 简单的递归计算 fibonacci 
- bubble_sort 1000000 生成1M 个随机的整数，并使用 bubble sort 对其排序，只对比排序的耗时

## 可选依赖

### GraalVM Native Image
如需测试 Java GraalVM Native Image 性能，请安装 GraalVM：

```bash
# macOS (使用 Homebrew)
brew install --cask graalvm/tap/graalvm-jdk17

# 设置环境变量
export PATH="/Library/Java/JavaVirtualMachines/graalvm-jdk-17/Contents/Home/bin:$PATH"
export JAVA_HOME="/Library/Java/JavaVirtualMachines/graalvm-jdk-17/Contents/Home"

# 安装 native-image 工具
gu install native-image
```


### 性能结果 (fib(42), Release/AOT 模式)

| 语言 | 时间 (ms) | 性能排名 | 相对性能 |
|------|-----------|----------|----------|
| Java (JVM) | 831 | 🥇 最快 | 100% |
| Zig  | 831 | 🥈 第二 | 100% |
| C (GCC) | 833 | 🥉 第三 | 100.2% |
| C (Clang) | 834 | 4️⃣ 第四 | 100.4% |
| Rust | 834 | 5️⃣ 第五 | 100.4% |
| Go   | 909 | 6️⃣ 第六 | 109.4% |
| Swift| 1048 | 7️⃣ 第七 | 126.1% |
| JavaScript (Bun) | 1318 | 8️⃣ 第八 | 158.6% |
| Java (GraalVM) | 1333 | 9️⃣ 第九 | 160.4% |
| Dart (AOT) | 1444 | 🔟 第十 | 173.8% |
| Lua (LuaJIT) | 2119 | 1️⃣1️⃣ 第十一 | 255% |
| JavaScript (Node.js) | 2551 | 1️⃣2️⃣ 第十二 | 307% |
| Dart (JIT) | 3474 | 1️⃣3️⃣ 第十三 | 418.1% |
| Python (PyPy) | 6375 | 1️⃣4️⃣ 第十四 | 767.1% |
| Lua | 20592 | 1️⃣5️⃣ 第十五 | 2478% |
| Python (CPython) | 38640 | 1️⃣6️⃣ 第十六 | 4649.8% |

### 性能对比图表

#### 📊 执行时间对比 (毫秒, 对数刻度)
```
编译型语言 (< 1.1s)
Java (JVM)       ████                                    831ms
Zig              ████                                    831ms  
C (GCC)          ████                                    833ms
C (Clang)        ████                                    834ms
Rust             ████                                    834ms
Go               █████                                   909ms
Swift            ██████                                 1048ms

中等性能 (1.1s - 3.5s)  
JavaScript (Bun) ███████                               1318ms
Java (GraalVM)   ███████                               1333ms
Dart (AOT)       ████████                              1444ms
Lua (LuaJIT)     ███████████                           2119ms
JavaScript (Node)███████████████                       2551ms
Dart (JIT)       ████████████████████                  3474ms

低性能 (> 3.5s)
Python (PyPy)    ████████████████████████████████      6375ms
Lua              ████████████████████████████████████████████████████████████████████████████████████████████████ 20592ms
Python (CPython) ████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ 38640ms
```

#### 🎯 性能分级对比
```
🏆 顶级性能 (< 1000ms)    
┌─ Java (JVM)       831ms  ████████████████████████████████████████████████████████████████████████████████████████████████
├─ Zig              831ms  ████████████████████████████████████████████████████████████████████████████████████████████████  
├─ C (GCC)          833ms  ████████████████████████████████████████████████████████████████████████████████████████████████
├─ C (Clang)        834ms  ████████████████████████████████████████████████████████████████████████████████████████████████
├─ Rust             834ms  ████████████████████████████████████████████████████████████████████████████████████████████████
└─ Go               909ms  ████████████████████████████████████████████████████████████████████████████████████████████████

🥈 优秀性能 (1-2s)
┌─ Swift            1048ms ████████████████████████████████████████████████████████████████████████████████████████████████
├─ JavaScript (Bun) 1318ms ████████████████████████████████████████████████████████████████████████████████████████████████
├─ Java (GraalVM)   1333ms ████████████████████████████████████████████████████████████████████████████████████████████████
└─ Dart (AOT)       1444ms ████████████████████████████████████████████████████████████████████████████████████████████████

🥉 中等性能 (2-7s)
┌─ Lua (LuaJIT)     2119ms ████████████████████████████████████████████████████████████████████████████████████████████████
├─ JavaScript (Node)2551ms ████████████████████████████████████████████████████████████████████████████████████████████████
├─ Dart (JIT)       3474ms ████████████████████████████████████████████████████████████████████████████████████████████████
└─ Python (PyPy)    6375ms ████████████████████████████████████████████████████████████████████████████████████████████████

📉 较低性能 (> 7s)
┌─ Lua              20592ms ███████████████████████████████████████████████████████████████████████████████████████████████
└─ Python (CPython) 38640ms ███████████████████████████████████████████████████████████████████████████████████████████████
```

#### 📈 相对性能倍数对比 (以最快为基准 1x)
```
1x    |████| Java (JVM), Zig                           831ms (基准)
1.0x  |████| C (GCC), C (Clang), Rust              833-834ms  
1.1x  |████| Go                                        909ms
1.3x  |████| Swift                                    1048ms
1.6x  |████| JavaScript (Bun), Java (GraalVM)    1318-1333ms
1.7x  |████| Dart (AOT)                              1444ms
2.6x  |████| Lua (LuaJIT)                            2119ms
3.1x  |████| JavaScript (Node.js)                    2551ms
4.2x  |████| Dart (JIT)                              3474ms
7.7x  |████████| Python (PyPy)                       6375ms
24.8x |████████████████████████| Lua                20592ms
46.5x |██████████████████████████████████████████████| Python (CPython) 38640ms
```

## 自动化测试脚本

### 快速运行所有测试
```bash
zig run ./run_fib.zig -- 42     # calculate fib(42)
```

### 测试说明
- 所有实现都计算 fib(42) = 267914296
- 通过命令行参数指定 n 值，便于灵活测试
- 统一使用 Release/AOT 优化模式进行公平对比
- **Java JVM 意外夺冠**：与系统级语言并列第一，JIT 优化威力显著
- **系统级语言集团**：Java JVM、Zig、C、Rust 性能极其接近，差距在 0.4% 内
- Go 在垃圾回收语言中表现优异，仅比最快语言慢 9.4%
- Java GraalVM Native Image 表现不如 JVM 版本
- **JavaScript 运行时差异巨大**：Bun 比 Node.js 快了约 93%
- Swift 和 Dart AOT 表现中等
- **JIT 编译语言优势明显**：LuaJIT 比解释版 Lua 快了约 871%
- **PyPy JIT 优化显著**：比 CPython 快了约 506%，但仍比编译型语言慢 7.7 倍
- **解释型语言性能**：Python (CPython) 最慢，比最快语言慢了约 46.5 倍
- Lua 解释器比 Python 快约 88%，但仍远慢于 JIT 版本
- Dart JIT 比 AOT 慢约 140%，体现了编译优化的重要性